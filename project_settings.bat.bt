@echo off
echo ğŸš€ Configurando Prototipo_chatbot...
echo.

REM Crear entorno virtual
echo ğŸ“¦ Creando entorno virtual...
python -m venv venv
if %errorlevel% neq 0 (
    echo âŒ Error creando entorno virtual
    pause
    exit /b 1
)

REM Activar entorno virtual
echo ğŸ”„ Activando entorno virtual...
call venv\Scripts\activate.bat

REM Actualizar pip
echo ğŸ“‹ Actualizando pip...
python -m pip install --upgrade pip

REM Instalar dependencias bÃ¡sicas primero
echo ğŸ“¦ Instalando dependencias bÃ¡sicas...
pip install flask pyyaml python-dotenv

REM Crear directorios necesarios
echo ğŸ“ Creando directorios...
mkdir config 2>nul
mkdir logs 2>nul
mkdir data\vectorstore\faiss 2>nul
mkdir data\vectorstore\chromadb 2>nul
mkdir data\documents 2>nul
mkdir data\temp 2>nul

REM Crear archivo .env bÃ¡sico
echo ğŸ“„ Creando archivo .env...
(
echo # Prototipo_chatbot - Variables de Entorno
echo FLASK_ENV=development
echo FLASK_DEBUG=True
echo SECRET_KEY=prototipo-chatbot-dev-secret-key
echo DEFAULT_LOCAL_MODEL=ollama:llama3.1:8b
echo DEFAULT_OPENAI_MODEL=gpt-4
echo EMBEDDING_MODEL=all-MiniLM-L6-v2
echo DEFAULT_VECTOR_STORE=faiss
echo RAG_K_DEFAULT=5
echo LOG_LEVEL=INFO
echo DEVELOPMENT_MODE=True
) > .env

REM Instalar todas las dependencias
echo ğŸ“¦ Instalando todas las dependencias...
pip install -r requirements.txt
if %errorlevel% neq 0 (
    echo âš ï¸ Algunas dependencias fallaron, pero continuando...
)

REM Verificar instalaciÃ³n
echo ğŸ” Verificando instalaciÃ³n...
python -c "import flask; print('âœ… Flask instalado correctamente')" 2>nul || echo "âŒ Flask no disponible"
python -c "import yaml; print('âœ… PyYAML instalado correctamente')" 2>nul || echo "âŒ PyYAML no disponible"

echo.
echo âœ… Setup completado!
echo.
echo ğŸš€ Para iniciar la aplicaciÃ³n:
echo    1. Activar entorno: venv\Scripts\activate.bat
echo    2. Ejecutar: python run.py
echo.
echo ğŸŒ Luego abrir: http://localhost:5000
echo.
pause